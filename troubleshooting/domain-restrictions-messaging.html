---
title: Mensajes de restricciones de dominio
parent: Troubleshooting
description: In this topic, you will learn how to display appropriate error messages when a video is not allowed to play because of domain restrictions. By default, Brightcove Player does not inform the user that a video is domain restricted.
---

<article class="bcls-article">
  <h1>Mensajes de restricciones de dominio</h1>
  <summary>{{ page.description }}</summary>
  <section class="bcls-section">
    <h2 id="Overview">Resumen</h2>
    <p>Es posible restringir dónde se puede ver un video a través de restricciones de dominio. La <a href="https://studio.support.brightcove.com/players/configuring-player-content-restrictions.html">Configuración de restricciones de contenido del reproductor</a> El documento le muestra cómo utilizar Video Cloud para aplicar restricciones de dominio. El documento que está leyendo ahora le indica cómo implementar código para informar a los usuarios que el reproductor está usando restricciones de dominio.</p>
    <p>De forma predeterminada, Brightcove Player no informa al usuario que un video que están intentando ver está en un reproductor de dominio restringido. El jugador simplemente muestra una pantalla negra. Si ve la consola, verá lo siguiente.</p>
    <figure class="bcls-figure"><img class="bcls-image" alt="domain restriction console error" src="/assets/images/troubleshooting/domain-restrictions-error-console.png" /></figure>
    <p>Esto no es muy útil, pero si marca la <strong>La red</strong> pestaña y haga clic en un <strong>Nombre</strong> que corresponda a su ID de video, luego verifique la <strong>Avance</strong> pestaña, verá un error más esclarecedor.</p>
    <figure class="bcls-figure"><img class="bcls-image" alt="domain message console network tab" src="/assets/images/troubleshooting/domain-restrictions-error-network.png" /></figure>
    <p>Este documento implementa una estrategia para que el usuario sepa que el video que está tratando de ver tiene un dominio restringido.</p>
  </section>
  <section class="bcls-section">
    <h2 id="errorobject">Objeto de error del catálogo de jugadores</h2>
    <p>La clave para crear un mensaje fácil de usar es la <code translate="No">error</code> objeto contenido en Brightcove Player's <code translate="No">catalog</code>. A continuación, se muestra un ejemplo de un error de restricción de dominio en una captura de pantalla de la consola de un navegador. Observe que el objeto contiene un <code translate="No">data</code> propiedad, que a su vez contiene una matriz. La matriz contendrá el último error que encontró el catálogo al cargar un video. En el ejemplo, verá que el elemento de la matriz informa un problema de restricción de dominio.</p>
    <figure class="bcls-figure"><img class="bcls-image" alt="catalog error object" src="/assets/images/troubleshooting/domain-restrictions-catalog-error.png" /></figure>
  </section>
  <section class="bcls-section">
    <h2 id="bccatalogerror">Manejar bc-catalog-error</h2>
    <p>Es posible que el manejo de errores en la <code translate="No">ready()</code> sección normal del <code translate="No">script</code> bloque pueda causar problemas. Por ejemplo, puede ocurrir que el <code translate="No">bc-catalog-error</code> evento se pueda enviar antes de que el reproductor esté listo y, si escucha el error en la <code translate="No">ready()</code> sección, no podrás manejar el error. Puede que descubra que no hay ningún problema en su código, pero el problema puede depender del navegador, así que tenga cuidado. Por esta razón, el código de manejo de errores en este documento utilizará el <code translate="No">one()</code> método de manejo de eventos para escuchar el <code translate="No">bc-catalog-error</code> en un bloque de código separado en lugar de dentro del <code translate="No">ready()</code> sección.</p>
  </section>
  <section class="bcls-section">
    <h2 id="htmlmessage">Mensaje en HTML</h2>
    <p>Una vez que comprenda la estructura del error que se produce y dónde se ubica, puede usar JavaScript para mostrar un error descriptivo para el usuario. Los pasos básicos de implementación son:</p>
    <ul>
      <li>Cree un elemento de destino en el que mostrar el mensaje.</li>
      <li>Asegúrese de que el jugador esté listo para actuar.</li>
      <li>Verifique si ha ocurrido algún error.</li>
      <li>Si es así, verifique si el error es un problema de restricción de dominio.</li>
      <li>En caso afirmativo, muestre el mensaje al usuario.</li>
    </ul>
    <p>El siguiente código implementa estos pasos.</p>
    <ul>
      <li>Línea 8: Inserte un elemento HTML, en este caso un párrafo, en el que inyectar texto; darle al elemento un <code translate="No">id</code> con fines de orientación.</li>
      <li>Línea 13: Utilice el <code translate="No">one()</code> método agregar un detector de eventos para el <code translate="No">bc-catalog-error</code> evento solo una vez.</li>
      <li>Línea 16: Utilice un <code translate="No">if</code> declaración para asegurarse de que se ha producido algún error.</li>
      <li>Línea 17: Asigne a una variable la información de error específica del objeto de error del catálogo de Brightcove Player.</li>
      <li>Línea 18: Utilice un <code translate="No">if</code> para asegurarse de que exista la información de error específica Y que el tipo de error sea de restricción de dominio.</li>
      <li>Línea 19: Inyecte un mensaje de texto apropiado en el elemento HTML creado en la línea 12.</li>
    </ul>
    <pre class="line-numbers">
<code class="language-html" translate="No">  &lt;video-js id="myPlayerID"
    data-video-id="3495887198001"
    data-account="1507807800001"
    data-player="4c8eb732-ba76-485c-a906-407365721633"
    data-embed="default"
    class="video-js" controls&gt;&lt;/video-js&gt;

    <span class="bcls-highlight">&lt;p id="textTarget"&gt;&lt;/p&gt;</span>

  &lt;script src="https://players.brightcove.net/1507807800001/4c8eb732-ba76-485c-a906-407365721633_default/index.min.js"&gt;&lt;/script&gt;

  &lt;script type="text/javascript"&gt;
    videojs.getPlayer('myPlayerID').<span class="bcls-highlight">one('bc-catalog-error', function(){</span>
      var myPlayer = this,
        specificError;
      <span class="bcls-highlight">if (myPlayer.catalog.error !== undefined) {
        specificError = myPlayer.catalog.error.data[0];
        if (specificError !== undefined &amp; specificError.error_subcode == "DOMAIN") {
          document.getElementById("textTarget").innerHTML = "The video you are trying to watch cannot be viewed as it is domain restricted.";
        };
      };</span>
    });

    videojs.getPlayer('myPlayerID').ready(function() {
      var myPlayer = this;
      console.log('in ready');
    });
  &lt;/script&gt;</code></pre>
    <p>La siguiente captura de pantalla muestra el mensaje que se muestra debajo del reproductor.</p>
    <figure class="bcls-figure"><img class="bcls-image" alt="error below player" src="/assets/images/troubleshooting/domain-restrictions-html-message.png" /></figure>
  </section>
  <section class="bcls-section">
    <h2 id="errorplugin">Mensaje a través del complemento de errores</h2>
    <p>Es posible que desee que se muestre el mensaje en el reproductor si el video tiene un dominio restringido. Puede hacer esto utilizando el complemento de errores. El complemento de errores se carga automáticamente en el reproductor, por lo que no es necesario realizar explícitamente esa operación. Para obtener detalles sobre el complemento de errores más allá de lo que se mencionará aquí, consulte el <a href="/plugins/display-error-messages-plugin.html">Mostrar complemento de mensajes de error</a> documento.</p>
    <ul>
      <li>Línea 43: Utilice el <code translate="No">one()</code> método agregar un detector de eventos para el <code translate="No">bc-catalog-error</code> evento solo una vez.</li>
      <li>Líneas 46-53: Llame al jugador <code translate="No">error()</code> método, pasando como un argumento JSON que define el <code translate="No">errors</code> información para mostrar. Tenga en cuenta que la elección de <code translate="No">-3</code> porque el código de error es arbitrario, y la única guía es no utilizar un código de error estándar (actualmente 1-5).</li>
      <li>Línea 57: Llama a <code translate="No">error()</code> método para mostrar la información de error personalizada. La lógica utilizada para determinar cuándo se ha producido el error de restricción de dominio es la misma que la anterior. El objeto pasado como argumento define qué mensaje de error mostrar.</li>
    </ul>
    <pre class="line-numbers" data-start="42">
<code class="language-html" translate="No">  &lt;script type="text/javascript"&gt;
    videojs.getPlayer('myPlayerID').<span class="bcls-highlight">one('bc-catalog-error', function(){</span>
      var myPlayer = this,
        specificError;
      <span class="bcls-highlight">myPlayer.errors({
        'errors': {
          '-3': {
            'headline': 'The video you are trying to watch cannot be viewed because of domain restrictions.',
            'type': 'DOMAIN'
          }
        }
      });</span>
      if (typeof(myPlayer.catalog.error) !== 'undefined') {
        specificError = myPlayer.catalog.error.data[0];
        if (specificError !== 'undefined' &amp; specificError.error_subcode == "DOMAIN") {
          <span class="bcls-highlight">myPlayer.error({code:'-3'});</span>
        };
      };
    });

    videojs.getPlayer('myPlayerID').ready(function() {
      var myPlayer = this;
    });
  &lt;/script&gt;</code></pre>
    <p>La siguiente captura de pantalla muestra la visualización del error definido por el complemento de error.</p>
    <figure class="bcls-figure"><img class="bcls-image" alt="defined error" src="/assets/images/troubleshooting/domain-restrictions-errors-plugin.png" /></figure>
  </section>
  <section id="generalerror" class="bcls-section">
    <h2>Pantalla de error general</h2>
    <p>Las dos secciones anteriores tratan específicamente sobre la visualización del error generado cuando un video con restricción geográfica se ve desde una ubicación restringida. Algunos errores no proporcionan el nivel de detalle que ofrece la restricción de dominio. Aquí se muestra un ejemplo de objeto de error de este tipo. Note que el <strong>datos</strong> El campo está vacío, mientras que con el error de restricción de dominio contenía información de error clave.</p>
    <figure class="bcls-figure"><img class="bcls-image" alt="general error object" src="/assets/images/troubleshooting/domain-restrictions-general-error.png" /></figure>
    <p>El siguiente código muestra cómo mostrar información de <code translate="No">catalog.error</code> sin importar el nivel de detalle. En un nivel alto, el código realiza lo siguiente:</p>
    <ul>
      <li>Comprueba si se ha producido un error de catálogo.</li>
      <li>Comprueba si en el objeto de error el <code translate="No">data</code> El campo contiene información de error específica. Si NO lo hace, el mensaje de error general se inserta en el HTML.</li>
      <li>Si hay información de error específica Y está relacionada con la restricción de dominio, se inyecta un mensaje apropiado en el HTML.</li>
      <li>Si hay información de error específica y no está relacionada con la restricción de dominio, el mensaje de error específico se inyecta en el HTML.</li>
    </ul>
    <pre class="line-numbers" data-start="69">
<code class="language-html" translate="No">  &lt;script type="text/javascript"&gt;
    videojs.getPlayer('myPlayerID').one('bc-catalog-error', function(){
      var myPlayer = this,
        specificError;
      if (myPlayer.catalog.error != undefined) {
        specificError = myPlayer.catalog.error.data[0];
        if (specificError == undefined) {
          document.getElementById("textTarget").innerHTML = "The following error has occurred: &lt;strong&gt;" + myPlayer.catalog.error.message + "&lt;/strong&gt;";
        } else if (specificError.error_subcode == "DOMAIN") {
          document.getElementById("textTarget").innerHTML = "The video you are trying to watch cannot be viewed because of domain restrictions.";
        } else {
          document.getElementById("textTarget").innerHTML = "The following error has occurred: " + specificError.message;
        };
      };
    });

    videojs.getPlayer('myPlayerID').ready(function() {
      var myPlayer = this;
    });
  &lt;/script&gt;</code></pre>
    <p>La siguiente captura de pantalla muestra el mensaje de error general que se muestra en HTML. Por supuesto, también puede usar el complemento de errores para mostrar el mensaje, como se muestra en la sección anterior de este documento.</p>
    <figure class="bcls-figure"><img class="bcls-image" alt="general error message display below player" src="/assets/images/troubleshooting/domain-restrictions-general-message.png" /></figure>
  </section>
</article>