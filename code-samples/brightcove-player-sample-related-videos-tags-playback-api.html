---
title: 'Muestra de Brightcove Player: Vídeos relacionados a través de etiquetas (API de reproducción)'
description: En este tema, aprenderás a recuperar vídeos con las mismas etiquetas que el vídeo actual y mostrarlos en una superposición. Esta muestra utiliza la API de reproducción para recuperar los videos.
parent: Code Samples
---
 <h1>{{ page.title }}</h1>
<article class="bcls-article">
  <summary>{{ page.description }}</summary>
  <section class="bcls-section">
    <h2 id="introduction">Introducción</h2>
    <p>En este tema, aprenderá cómo recuperar datos de la API de reproducción y mostrarlos en una superposición para Brightcove Player. Esta superposición muestra un conjunto de vídeos relacionados (mediante etiquetas o metadatos) en su cuenta cuando la reproducción se pausa o finaliza. También vea el <a href="/code-samples/brightcove-player-sample-related-videos-tags-cms-api.html">Versión de la API de CMS</a> de esta muestra.</p>
    <aside class="bcls-aside bcls-aside--information">El contenido de este documento se aplica únicamente a Video Cloud.</aside>
  </section>
  <section class="bcls-section">
    <h2 id="limitations">Limitaciones</h2>
    <aside class="bcls-aside bcls-aside--information">Este ejemplo y el código asociado se proporcionan como guía para el desarrollo de su producción. El código no está certificado para uso en producción ni se admite oficialmente.</aside>
  </section>
  <section class="bcls-section">
    <h2 id="Player_example">Ejemplo de jugador</h2>
    <!-- UPDATE description -->

    <p>En este ejemplo se muestra una superposición interactiva de miniaturas de vídeo relacionadas cuando la reproducción está en pausa o ha finalizado. Comience a reproducir el vídeo que aparece a continuación. Cuando pausas la reproducción o cuando finaliza el vídeo, aparecerá una superposición de vídeos relacionados.</p>
    <!-- UPDATE codepen here -->

    <p data-height="475" data-theme-id="34967" data-slug-hash="POWyeR" data-default-tab="result" data-user="bcls1969" data-embed-version="2" data-pen-title="18485-related-videos-tags-playback-api" class="codepen">Ver la prisma <a href="https://codepen.io/team/bcls1969/pen/POWyeR/">18485-etiquetas-de-videos-relacionados-reproducción-api</a> por Brightcove Learning Services (<a href="https://codepen.io/team/rcrooks1969"> bcls1969</a> ) en <a href="https://codepen.io">CodePen</a>.</p>
    <script async src="https://production-assets.codepen.io/assets/embed/ei.js"></script><!-- UPDATE link to GitHub source -->

    <h3>Código fuente</h3>
          <p>Ver el <a href="https://github.com/BrightcoveLearning/18485-related-videos-tags-playback-api">solución completa en GitHub</a>.</p>
  </section>
  <section class="bcls-section">
    <h2 id="Overview">Resumen</h2>
    <p>Esta muestra llama a la API de reproducción y busca videos relacionados en la misma cuenta, que tienen el mismo valor de etiqueta que el video cargado en el reproductor. Estos videos relacionados se muestran luego como miniaturas interactivas en una superposición cuando la reproducción de video está en pausa o ha finalizado. Al seleccionar una miniatura en la superposición, carga el vídeo asociado en el reproductor e inicia la reproducción.</p>
    <aside class="bcls-aside bcls-aside--information">Las solicitudes de búsqueda con la API de reproducción requieren una clave de política que sea <a href="https://apis.support.brightcove.com/policy/getting-started/overview-policy-api.html#Search_videos">habilitado para búsqueda</a>.</aside> <aside class="bcls-aside bcls-aside--warning">Tenga en cuenta que este ejemplo expone su clave de política habilitada para búsqueda en el lado del cliente. Esto podría permitir que otros lean los videos y los metadatos asociados en su cuenta. Si la seguridad es un problema, considere usar el <span translate="No">API de CMS</span> en lugar de. Para obtener más detalles, consulte la <a href="/code-samples/brightcove-player-sample-related-videos-tags-cms-api.html">Muestra de jugador de Brightcove: Vídeos relacionados a través de etiquetas (metadatos)</a> documento.</aside>
    <p>Si es nuevo en el uso de la API de reproducción, comience por revisar los siguientes documentos:</p>
    <ul>
      <li><a href="https://apis.support.brightcove.com/playback/">Descripción general de la API de reproducción</a></li>
      <li><a href="https://apis.support.brightcove.com/cms/searching/cms-and-playback-apis-video-search-v2.html">Búsqueda de videos con la API de reproducción</a></li>
    </ul>
  </section>
  <section class="bcls-section">
    <details>
      <summary><h2 id="Using_the_CodePen">Uso de CodePen</h2></summary>
      <p>Estos son algunos consejos para utilizar eficazmente el CodePen anterior:</p>
      <ul>
        <li>Cambie la visualización real del reproductor haciendo clic en el <strong translate="No">Resultado</strong> botón.</li>
        <li>Haga clic en el <strong translate="No">HTML / CSS / JS</strong> botones para mostrar UNO de los tipos de código.</li>
        <li>Más adelante, en este documento, la lógica, el flujo y el estilo utilizados en la aplicación se analizarán en la configuración de <a href="#Player/HTML_configuration">reproductor/HTML</a>, Flujo de <a href="#Application_flow">aplicaciones</a> y Estilo de <a href="#Application_styling">la aplicación.</a> secciones. La mejor manera de seguir la información de estas secciones es:
          <ol>
            <li>Haga clic en el <strong translate="No">EDITAR CODEPEN</strong> en el CodePen y tenga el código disponible en un navegador / pestaña del navegador.</li>
            <li>En CodePen, ajusta el código que quieres que se muestre. Puede cambiar el ancho de las distintas secciones de código dentro de CodePen.</li>
            <li>Ver el <a href="#Player/HTML_configuration">Configuración de reproductor / HTML</a> , <a href="#Application_flow">Flujo de aplicación</a> y / o <a href="#Application_styling">Estilo de aplicación</a> secciones en otra pestaña del navegador / navegador. Ahora podrá seguir las explicaciones del código y, al mismo tiempo, ver el código.</li>
          </ol>
        </li>
      </ul>
    </details>
  </section>
  <section class="bcls-section">
    <details>
      <summary><h2 id="Development_sequence">secuencia de desarrollo</h2></summary>
      <p>Esta es la secuencia de desarrollo recomendada:</p>
      <ol>
        <li>Utilice la implementación del reproductor de incrustación en la página para probar la funcionalidad de su reproductor, complemento y CSS (si es necesario CSS)</li>
        <li>Coloque el JavaScript y CSS del plugin en archivos separados para pruebas locales</li>
        <li>Implementa el código del plugin y CSS en tu servidor una vez que hayas resuelto cualquier error.</li>
        <li>Usa Studio para agregar el plugin y CSS a tu reproductor</li>
        <li>Reemplace la implementación del reproductor de incrustación en página si determina que la implementación de iframe se ajusta mejor (se detalla en la siguiente sección)</li>
      </ol>
      <p>Para obtener más información sobre estos pasos, consulte la sección <a href="/coding-topics/step-step-plugin-development.html">Paso a paso: </a> Guía de desarrollo de plugins.</p>
      <h3>iframe o incrustación en página</h3>
      <p>Al desarrollar mejoras para Brightcove Player, deberás decidir si el código se ajusta mejor a la implementación de iframe o incrustación en la página. La recomendación de práctica recomendada es crear un complemento para usarlo con una implementación de iframe. Las ventajas de utilizar el reproductor iframe son:</p>
      <ul>
        <li>Sin colisiones con JavaScript y/o CSS existentes</li>
        <li>Responde automáticamente</li>
        <li>El iframe facilita el uso en aplicaciones de redes sociales (o siempre que el vídeo tenga que «viajar» a otras aplicaciones)</li>
      </ul>
      <p>Aunque la integración del reproductor de incrustación en la página puede ser más compleja, hay ocasiones en que planificará el código en torno a esa implementación. Para generalizar, este enfoque es mejor cuando la página que contiene necesita comunicarse con el reproductor. En concreto, estos son algunos ejemplos:</p>
      <ul>
        <li>El código de la página que contiene necesita escuchar y actuar en función de los eventos de los jugadores</li>
        <li>El reproductor utiliza estilos de la página que lo contiene</li>
        <li>El iframe hará que la lógica de la aplicación falle, como un redireccionamiento desde la página que contiene</li>
      </ul>
      <p>Incluso si tu implementación final no utiliza el código iframe, puedes seguir usando el código de incrustación en la página con un plugin para tu JavaScript y un archivo separado para tu CSS. Esto encapsula tu lógica para que puedas utilizarla fácilmente en varios reproductores.</p>
    </details>
  </section>
  <section class="bcls-section">
    <h2 id="API/Plugin_resources_used">Recursos de API/plugins utilizados</h2>
    <!-- UPDATE table, remove unneeded columns -->

    <table class="bcls-table">
      <thead class="bcls-table__head">
        <tr>
          <th>Métodos API</th>
          <th>Eventos API</th>
          <th>Propiedades de API</th>
        </tr>
      </thead>
      <tbody class="bcls-table__body">
        <tr>
          <td><a href="https://docs.brightcove.com/brightcove-player/current-release/Player.html#play">jugar ()</a></td>
          <td><a href="https://docs.brightcove.com/brightcove-player/current-release/Player.html#event:loadedmetadata">metadatos cargados</a></td>
          <td><a href="/references/video-metadata-mediainfo.html">mediainfo.account_id</a></td>
        </tr>
        <tr>
          <td><a href="/references/player-catalog.html#load">catalog.load ()</a></td>
          <td>&nbsp;</td>
          <td><a href="/references/video-metadata-mediainfo.html">mediainfo.tags [0]</a></td>
        </tr>
        <tr>
          <td><a href="/references/player-catalog.html#getVideo">Catalog.getVideo ()</a></td>
          <td>&nbsp;</td>
          <td><a href="/references/video-metadata-mediainfo.html">mediainfo.name</a></td>
        </tr>
      </tbody>
    </table>
  </section>
  <!-- UPDATE player and HTML configuration -->

  <section class="bcls-section">
    <h2 id="Player/HTML_configuration">Configuración de reproductor/HTML</h2>
    <p>El complemento <a href="/plugins/display-overlay-plugin.html">Overlay</a> se define e inicializa en el código JavaScript de este ejemplo. La razón por la que se hace aquí, es que necesitamos obtener los metadatos de los vídeos relacionados antes de inicializar la superposición.</p>
    <p>Si quieres incluir el complemento Overlay en la configuración de tu reproductor, puedes agregar los archivos JavaScript y CSS de Superposición en el módulo Players de Video Cloud Studio. En el <a href="https://studio.support.brightcove.com/players/configuring-player-plugins.html"><strong>Complementos</strong> sección</a> , deja el <strong>Nombre</strong> propiedad en blanco, para que pueda inicializar el complemento dentro del código.</p>
    <h3>Otros HTML</h3>
    <p>Recuerda añadir el <code translate="No">id</code> atributo a la <code translate="No">video</code> etiqueta en el código de inserción del reproductor.</p>
    <pre>
<code class="language-html" translate="No">&lt;video-js <span class="bcls-highlight">id="myPlayerID"</span>
		...</code></pre>
  </section>
  <!-- UPDATE application flow -->

  <section class="bcls-section">
    <h2 id="Application_flow">Flujo de aplicaciones</h2>
    <p>La lógica básica detrás de esta aplicación es:</p>
    <ul>
      <li>Cree variables que definan valores para la URL básica de la API de reproducción y su clave de política.</li>
      <li>Espere a que el vídeo comience a cargarse para recuperar los metadatos de vídeo.</li>
      <li>Configure la solicitud para la API de reproducción.</li>
      <li>Realice la solicitud a la API de reproducción para obtener los primeros 9 videos relacionados.</li>
      <li>Dar formato al contenido superpuesto para mostrar las miniaturas de cada uno de los vídeos relacionados.</li>
      <li>Cuando un usuario selecciona una de las miniaturas de vídeo relacionadas, cárgala en el reproductor e inicia la reproducción.</li>
    </ul>
    <!-- UPDATE task 1 -->

    <h3>Definir valores</h3>
    <p>Cree variables que definan valores para la URL básica de la API de reproducción y su clave de política.</p>
    <!-- UPDATE task 2 -->

    <h3>Esperar metadatos cargados</h3>
    <p>Busque el código etiquetado:</p>
    <pre>
<code class="language-javascript" translate="No">// +++ Wait for loadedmetadata +++</code></pre>
    <p>Espere a que el vídeo comience a cargarse escuchando el <code translate="No">loadedmetadata</code> evento. Esto garantiza que los metadatos de vídeo, como el identificador de cuenta, el nombre y los valores de etiqueta, estén disponibles en el <code translate="No">mediainfo</code> objeto.</p>
    <!-- UPDATE task 3 -->

    <h3>Configurar la solicitud de API</h3>
    <p>Busque el código etiquetado:</p>
    <pre>
<code class="language-javascript" translate="No">// +++ Setup the API request +++</code></pre>
    <p>Con la información del video cargado actualmente en el reproductor, cree una solicitud de búsqueda de la API de reproducción para videos en la misma cuenta. La búsqueda buscará vídeos que tengan el mismo valor que la primera etiqueta del vídeo actual. Excluirá cualquier vídeo con el mismo nombre que el vídeo actual y limitará el número de vídeos devueltos a 9. Ese es el número de personas que encajarán en nuestro diseño de superposición.</p>
    <!-- UPDATE task 4 -->

    <h3>Realizar la solicitud de la API de reproducción</h3>
    <p>Busque el código etiquetado:</p>
    <pre>
<code class="language-javascript" translate="No">// +++ Make the Playback API request +++</code></pre>
    <p>Envíe una solicitud HTTP GET al servicio web RESTful de la API de reproducción. Analiza los datos devueltos en formato JSON. Si se produce un error, muestre un mensaje de error.</p>
    <!-- UPDATE task 5 -->

    <h3>Dar formato al contenido de superposición</h3>
    <p>Busque el código etiquetado:</p>
    <pre>
<code class="language-javascript" translate="No">// +++ Format the overlay content +++</code></pre>
    <p>Para dar formato al contenido superpuesto, realizará lo siguiente:</p>
    <ul>
      <li>Extraiga la identificación, el nombre y la miniatura de cada video relacionado devuelto desde la API de reproducción y guárdelo en una matriz.</li>
      <li>Al recorrer la matriz de vídeo relacionada, cree un <code translate="No">&lt;div&gt;</code> contenedor de listas de vídeos que contenga un <code translate="No">&lt;div&gt;</code> elemento para cada vídeo relacionado. Esto se convertirá en el contenido superpuesto.</li>
      <li>Inicialice el complemento Overlay con el contenido de vídeos relacionados recién creado. Verá una cuadrícula de miniaturas de vídeo relacionadas cuando se muestre la superposición. Muestra la superposición cuando la reproducción de vídeo está en pausa o ha finalizado. Oculta la superposición cuando se reproduce el vídeo principal.</li>
    </ul>
    <!-- UPDATE task 4 -->

    <h3>Cargar y reproducir vídeos relacionados</h3>
    <p>Busque el código etiquetado:</p>
    <pre>
<code class="language-javascript" translate="No">// +++ Load and play related video +++</code></pre>
    <p>Cree una función que cargue e inicie la reproducción del vídeo relacionado seleccionado por el usuario.</p>
  </section>
  <!-- UPDATE CSS description -->

  <section class="bcls-section">
    <h2 id="Application_styling">Estilismo de aplicaciones</h2>
    <p>El CSS estiliza la cuadrícula de miniaturas de vídeos relacionados para la superposición.</p>
  </section>
  <section class="bcls-section">
    <h2 id="Plugin_code">Código de plugin</h2>
    <p>Normalmente, al convertir JavaScript en un complemento de Brightcove Player, se necesitan cambios nominales. Un cambio necesario es reemplazar el uso estándar del <code translate="No">ready()</code> método por el código que define un complemento.</p>
    <p>Aquí está el código de inicio a JavaScript muy utilizado que funcionará con el reproductor:</p>
    <pre class="line-numbers">
<code class="language-javascript" translate="No">videojs.getPlayer('myPlayerID').ready(function() {
			var myPlayer = this;
			...
		});</code></pre>
    <p>Cambiarás la primera línea para usar la sintaxis estándar para iniciar un plugin de Brightcove Player:</p>
    <pre class="line-numbers">
<code class="language-javascript" translate="No">videojs.registerPlugin('pluginName', function(options) {
			var myPlayer = this;
			...
		});</code></pre>
    <!-- UPDATE path to plugin's JavaScript -->

    <p>Como se mencionó anteriormente, puede ver el código JavaScript del complemento en el repositorio de GitHub correspondiente de este documento: <a href="https://github.com/BrightcoveLearning/18485-related-videos-tags-playback-api/blob/master/plugin/related-videos.js">related-videos.js</a>.</p>
    <h3>Uso del complemento con un reproductor</h3>
    <p>Una vez que tengas los archivos CSS y JavaScript del plugin almacenados en una ubicación accesible a Internet, puedes usar el plugin con un reproductor. En Studio's <strong>JUGADORES</strong> módulo puedes elegir un jugador, luego en el <strong>PLUGINS</strong> sección agregue las URL a los archivos CSS y JavaScript, y también agregue el <strong>Nombre</strong> y <strong>Opciones</strong> , si se necesitan opciones.</p>
    <aside class="bcls-aside bcls-aside--tip">Para obtener más información sobre el uso de Studio para asignar complementos a los reproductores, consulte la <a href="https://studio.support.brightcove.com/players/configuring-player-plugins.html">Configuración de complementos del reproductor</a> documento.</aside>
  </section>
</article>