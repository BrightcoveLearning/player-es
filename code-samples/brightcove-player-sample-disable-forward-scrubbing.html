---
title: 'Muestra de Brightcove Player: Desactivar fregado hacia adelante'
description: 'En este tema, aprenderá a usar una función de middleware para deshabilitar el barrido hacia adelante hasta que se haya reproducido un porcentaje específico del video.'
parent: Code Samples
---
 <h1>{{ page.title }}</h1>
<article class="bcls-article">
  <summary>{{ page.description }}</summary>

  <section class="bcls-section">
    <h2 id="Player_example">Ejemplo de jugador</h2>
    <!-- UPDATE description -->
    
    <aside class="bcls-aside bcls-aside--information">Este ejemplo y el código asociado se proporcionan como guía para el desarrollo de su producción. El código no está certificado para uso en producción ni se admite oficialmente.</aside>
    <p>Inicialmente, NO podrá desplazarse hacia adelante, pero es posible hacerlo hacia atrás. Una vez que el video alcanza el 50% de reproducción, puede desplazarse hacia adelante o hacia atrás. El porcentaje de cuándo permitir la limpieza hacia adelante se establece fácilmente en el código.</p>
    <!-- UPDATE codepen here -->
    
    <p data-height="452" data-theme-id="34967" data-slug-hash="OvzyMN" data-default-tab="result" data-user="rcrooks1969" data-embed-version="2" data-pen-title="Disable Forward Scrubbing" class="codepen">Ver la pluma <a href="https://codepen.io/team/rcrooks1969/pen/OvzyMN/">Desactivar fregado hacia adelante</a> por Brightcove Learning Services (<a href="https://codepen.io/rcrooks1969"> rcrooks1969</a> ) en <a href="https://codepen.io">CodePen</a>.</p>
    <script async src="https://static.codepen.io/assets/embed/ei.js"></script><!-- UPDATE link to GitHub source -->
    
    <h3>Código fuente</h3>
          <p>Ver el <a href="https://github.com/BrightcoveLearning/18571-disable-forward-scrubbing">solución completa en GitHub</a>.</p>
  </section>
  <section class="bcls-section">
    <details>
      <summary><h2 id="Using_the_CodePen">Uso de CodePen</h2></summary>
      <p>Estos son algunos consejos para utilizar eficazmente el CodePen anterior:</p>
      <ul>
        <li>Cambie la visualización real del reproductor haciendo clic en el <strong translate="No">Resultado</strong> botón.</li>
        <li>Haga clic en el <strong translate="No">HTML / CSS / JS</strong> botones para mostrar UNO de los tipos de código.</li>
        <li>Más adelante, en este documento, la lógica, el flujo y el estilo utilizados en la aplicación se analizarán en la configuración de <a href="#Player/HTML_configuration">reproductor/HTML</a>, Flujo de <a href="#Application_flow">aplicaciones</a> y Estilo de <a href="#Application_styling">la aplicación.</a> secciones. La mejor manera de seguir la información de estas secciones es:
          <ol>
            <li>Haga clic en el <strong translate="No">EDITAR CODEPEN</strong> en el CodePen y tenga el código disponible en un navegador / pestaña del navegador.</li>
            <li>En CodePen, ajusta el código que quieres que se muestre. Puede cambiar el ancho de las distintas secciones de código dentro de CodePen.</li>
            <li>Ver el <a href="#Player/HTML_configuration">Configuración de reproductor / HTML</a> , <a href="#Application_flow">Flujo de aplicación</a> y / o <a href="#Application_styling">Estilo de aplicación</a> secciones en otra pestaña del navegador / navegador. Ahora podrá seguir las explicaciones del código y, al mismo tiempo, ver el código.</li>
          </ol>
        </li>
      </ul>
    </details>
  </section>
  
  <section class="bcls-section">
    <h2 id="Middleware_functions">Funciones de middleware</h2>
    <p>En este ejemplo se utiliza middleware Video.js para implementar la solución de código. En un nivel muy alto, los casos de uso en los que el middleware es de mayor valor es cuando desea interceptar y alterar los comportamientos principales del reproductor, como establecer la fuente o la hora actual. El middleware Video.js en general no se analiza extensamente en este documento, pero se explica el código real utilizado para la función middleware. Aquí hay documentos de fuentes Video.js que detallan el middleware:</p>
    <ul>
      <li><a href="http://docs.videojs.com/tutorial-middleware.html">Middleware (del conjunto de documentación Video.js)</a></li>
      <li><a href="http://blog.videojs.com/feature-spotlight-middleware/">Característica Spotlight: Middleware (del blog Video.js)</a></li>
      <li><a href="https://github.com/videojs/videojs-playbackrate-adjuster">videojs-playbackrate-adjuster (una aplicación de ejemplo)</a></li>
    </ul>
    <h3>Implementación de funciones de middleware con Brightcove Player</h3>
    <p>La forma más sencilla de utilizar una función middleware es:</p>
    <ol>
      <li>Escribe la función middleware.</li>
      <li>Coloque la función middleware en la página con el reproductor en una <code translate="No">script</code> etiqueta o incluya la función middleware utilizando el <code translate="No">src</code> atributo con un <code translate="No">script</code> etiqueta. Ambas implementaciones se mostrarán en este documento.</li>
      <li>Registre la función middleware con el reproductor utilizando el <code translate="No">use()</code> método, como se muestra a continuación:
        <pre class="line-numbers">
<code class="language-javascript" translate="No">videojs.use('mimeType', functionName);</code></pre>
        <p>Para el <strong>tipo mime,</strong> puede utilizar un tipo mime de vídeo estándar, como <strong>video/mp4</strong>, o usar un <strong>*</strong> si desea que la función middleware actúe sobre todos mimetipos.</p>
      </li>
    </ol>
  </section>
  <!-- UPDATE player and HTML configuration -->
  
  <section class="bcls-section">
    <h2 id="Player/HTML_configuration">Configuración de reproductor/HTML</h2>
    <p>En esta sección se detalla cualquier configuración especial necesaria durante la creación del reproductor. Además, se describen otros elementos HTML que deben agregarse a la página, más allá del código de implementación del reproductor de incrustación de la página.</p>
    <h3>Configuración del reproductor</h3>
    <p>No se requiere ninguna configuración especial para el reproductor de Brightcove que crea para este ejemplo.</p>
    <h3>Otros HTML</h3>
    <p>No se añaden otros elementos HTML a la página.</p>
  </section>
  <!-- UPDATE application flow -->
  
  <section class="bcls-section">
    <h2 id="Application_flow">Flujo de aplicaciones</h2>
    <p>La lógica básica detrás de esta aplicación es:</p>
    <ul>
      <li>Implementar la sintaxis básica para una función de middleware, nombrar la función <code translate="No">disableForwardScrubbing</code>.</li>
      <li>Implementar el requerido <code translate="No">setSource()</code> método.</li>
      <li>Alterar el <code translate="No">setCurrentTime()</code> método para comprobar si el tiempo al que el espectador está intentando realizar un scrub es menor que el tiempo actual en el reproductor, o si ha pasado el porcentaje de scrub forward. Si alguno de los dos es cierto, mueva el cabezal de reproducción a ese momento. Si es falso, mantenga el video reproduciéndose a la hora actual.</li>
    </ul>
    <!-- UPDATE task 1 -->
    
    <h3>Crear el esqueleto para la función middleware</h3>
    <p>Busque el código etiquetado:</p>
    <pre>
<code class="language-javascript" translate="No">// +++ Define the middleware function+++</code></pre>
    <p>La sintaxis básica para crear una función middleware es la siguiente:</p>
    <pre class="line-numbers">
<code class="language-javascript" translate="No">var disableForwardScrubbing = function(player) {
  return {
  ...
};</code></pre>
    <p>Tenga en cuenta que el <code translate="No">player</code> objeto se pasa a la función.</p>
    <!-- UPDATE task 2 -->
    
    <h3>Implementar el <code translate="No">setSource()</code> método</h3>
    <p>Busque el código etiquetado:</p>
    <pre>
<code class="language-javascript" translate="No">// ### Implement setSource() ###</code></pre>
    <p>Este es un método obligatorio para cada función de middleware. Utilizando la sintaxis mostrada significa que el middleware siempre estará seleccionado, independientemente del tipo de vídeo:</p>
    <pre class="line-numbers">
<code class="language-javascript" translate="No">setSource: function setSource(srcObj, next) {
  next(null, srcObj);
},</code></pre>
    <!-- UPDATE task 3 -->
    
    <h3>Modifique el método setCurrentTime ()</h3>
    <p>Busque el código etiquetado:</p>
    <pre>
<code class="language-javascript" translate="No">// ### Alter the setCurrentTime method ###</code></pre>
    <p>Este bloque de código es donde el real <code translate="No">setCurrentTime()</code> el método está alterado. Para entender esto, el primer punto a saber es que el <code translate="No">ct</code> El valor pasado a la función refleja el valor al que el espectador está depurando. La <code translate="No">if</code> La declaración verifica si el nuevo valor es menor que el tiempo actual del jugador o excede el porcentaje para permitir la limpieza hacia adelante. Si alguno de los dos es verdadero, se devuelve el nuevo valor, lo que hace que la cabeza lectora se mueva al nuevo valor. Si la condición es falsa, lo que significa que el espectador está intentando desplazarse hacia adelante antes de que se le permita, se devuelve la hora actual del jugador y la reproducción no se modifica.</p>
    <pre class="line-numbers">
<code class="language-javascript" translate="No">setCurrentTime: function setCurrentTime(ct) {
  var percentAllowForward = 50,
   // Determine percentage of video played
   percentPlayed = player.currentTime() / player.duration() * 100;
   // Check if the time scrubbed to is less than the current time
   // or if passed scrub forward percentage
  if ( ct &lt; player.currentTime() || percentPlayed &gt; percentAllowForward ) {
    // If true, move playhead to desired time
    return ct;
  }
  // If time scrubbed to is past current time and not passed percentage
  // leave playhead at current time
  return player.currentTime();
}</code></pre>
  </section>
  <!-- UPDATE CSS description -->
  
  <section class="bcls-section">
    <h2 id="Application_styling">Estilismo de aplicaciones</h2>
    <p>El CSS de la página simplemente establece el tamaño del reproductor.</p>
  </section>
  <section class="bcls-section">
    <h2 id="Using_the_middleware_function">Uso de la función middleware</h2>
    <p>Una vez que se haya escrito la función middleware, desea usarla. Antes se mencionaron dos formas y se detallarán ahora.</p>
    <h3>Código en la misma página que el reproductor</h3>
    <p>Aquí defines la función middleware en la misma página que el reproductor y luego la registras.</p>
    <pre class="line-numbers">
<code class="language-html" translate="No">&lt;video-js id="myPlayerID"
  data-video-id="5701202551001"
  data-account="1752604059001"
  data-player="default"
  data-embed="default"
  data-application-id
  class="video-js"
  controls&gt;&lt;/video-js&gt;
&lt;script src="https://players.brightcove.net/1752604059001/default_default/index.min.js"&gt;&lt;/script&gt;

<span class="bcls-highlight">&lt;script type="text/javascript"&gt;
  // +++ Define the middleware function+++
  var disableForwardScrubbing = function(player) {
    return {
      // +++ Implement setSource() +++
      setSource: function setSource(srcObj, next) {
        next(null, srcObj);
      },
      // +++ Alter the setCurrentTime method +++
      setCurrentTime: function setCurrentTime(ct) {
        var percentAllowForward = 50,
         // Determine percentage of video played
         percentPlayed = player.currentTime() / player.duration() * 100;
         // Check if the time scrubbed to is less than the current time
         // or if passed scrub forward percentage
        if ( ct &lt; player.currentTime() || percentPlayed &gt; percentAllowForward ) {
          // If true, move playhead to desired time
          return ct;
        }
        // If time scrubbed to is past current time and not passed percentage
        // leave playhead at current time
        return player.currentTime();
      }
    }
  };

  // Register the middleware with the player
  videojs.use('*', disableForwardScrubbing);</span>

&lt;/script&gt;</code></pre>
    <h3>Código incluido en la página del jugador</h3>
    <p>En el siguiente código, JavaScript para la función de middleware y el <code translate="No">use()</code> El método para registrarlo simplemente se incluye en la página.</p>
    <pre class="line-numbers">
<code class="language-html" translate="No">&lt;video-js id="myPlayerID"
  data-video-id="5701202551001"
  data-account="1752604059001"
  data-player="default"
  data-embed="default"
  data-application-id
  class="video-js"
  controls&gt;&lt;/video-js&gt;
&lt;script src="https://players.brightcove.net/1752604059001/default_default/index.min.js"&gt;&lt;/script&gt;

<span class="bcls-highlight">&lt;script src="disable-forward-scrubbing.js"&gt;&lt;/script&gt;</span></code></pre>
    <p>Ver el <a href="https://github.com/BrightcoveLearning/18571-disable-forward-scrubbing/tree/master/function-in-separate-file">función-en-archivo-separado</a> en el repositorio de GitHub para obtener el código completo.</p>
  </section>
</article>