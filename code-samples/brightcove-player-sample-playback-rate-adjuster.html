---
title: 'Muestra de Brightcove Player: Ajustador de velocidad de reproducción'
description: 'En este tema, aprenderá cómo agregar un botón de velocidad de reproducción a la barra de control de Brightcove Player y cómo usar middleware para mostrar correctamente la hora actual y la duración del video mientras cambia entre velocidades de reproducción.'
parent: Code Samples
---
 <h1>{{ page.title }}</h1>
<article class="bcls-article">
  <summary>{{ page.description }}</summary>

  <section class="bcls-section">
    <h2 id="Player_example">Ejemplo de jugador</h2>
    <!-- UPDATE description -->
    
    <aside class="bcls-aside bcls-aside--information">Este ejemplo y el código asociado se proporcionan como guía para el desarrollo de su producción. El código no está certificado para uso en producción ni se admite oficialmente.</aside>
    <p>Inicie la reproducción de vídeo y seleccione el botón de velocidad de reproducción de la barra de control (el valor predeterminado es 1x). Elige una tarifa diferente para ver cómo cambia la velocidad de reproducción de vídeo. Tenga en cuenta que cuando cambia la velocidad de reproducción, el tiempo de duración mostrado se vuelve a calcular en función de la velocidad seleccionada.</p>
    <!-- <aside class="bcls-aside bcls-aside--tip">If you don't want to code the middleware functions, you can use a plug and play solution. For details, see the  <a href="#Code_in_a_separate_JavaScript_file">Code in a separate JavaScript file</a> section.</aside> --><!-- UPDATE codepen here -->
    
    <p data-height="490" data-theme-id="34967" data-slug-hash="aGEVYZ" data-default-tab="result" data-user="bcls1969" data-embed-version="2" data-pen-title="Playback Rate Adjuster" class="codepen">Ver la pluma <a href="https://codepen.io/team/bcls1969/pen/aGEVYZ/">Ajustador de velocidad de reproducción</a> por Brightcove Learning Services (<a href="https://codepen.io/team/rcrooks1969"> bcls1969</a> ) en <a href="https://codepen.io">CodePen</a>.</p>
    <script async src="https://static.codepen.io/assets/embed/ei.js"></script><!-- UPDATE link to GitHub source -->
    
    <h3>Código fuente</h3>
          <p>Ver el <a href="https://github.com/BrightcoveLearning/18597-playback-rate-adjuster">solución completa en GitHub</a>.</p>
  </section>
  <section class="bcls-section">
    <details>
      <summary><h2 id="Using_the_CodePen">Uso de CodePen</h2></summary>
      <p>Estos son algunos consejos para utilizar eficazmente el CodePen anterior:</p>
      <ul>
        <li>Cambie la visualización real del reproductor haciendo clic en el <strong translate="No">Resultado</strong> botón.</li>
        <li>Haga clic en el <strong translate="No">HTML / CSS / JS</strong> botones para mostrar UNO de los tipos de código.</li>
        <li>Más adelante, en este documento, la lógica, el flujo y el estilo utilizados en la aplicación se analizarán en la configuración de <a href="#Player/HTML_configuration">reproductor/HTML</a>, Flujo de <a href="#Application_flow">aplicaciones</a> y Estilo de <a href="#Application_styling">la aplicación.</a> secciones. La mejor manera de seguir la información de estas secciones es:
          <ol>
            <li>Haga clic en el <strong translate="No">EDITAR CODEPEN</strong> en el CodePen y tenga el código disponible en un navegador / pestaña del navegador.</li>
            <li>En CodePen, ajusta el código que quieres que se muestre. Puede cambiar el ancho de las distintas secciones de código dentro de CodePen.</li>
            <li>Ver el <a href="#Player/HTML_configuration">Configuración de reproductor / HTML</a> , <a href="#Application_flow">Flujo de aplicación</a> y / o <a href="#Application_styling">Estilo de aplicación</a> secciones en otra pestaña del navegador / navegador. Ahora podrá seguir las explicaciones del código y, al mismo tiempo, ver el código.</li>
          </ol>
        </li>
      </ul>
    </details>
  </section>
  <section class="bcls-section">
    <details>
      <summary><h2 id="Development_sequence">secuencia de desarrollo</h2></summary> 
      <p>Esta es la secuencia de desarrollo recomendada:</p>
      <ol>
        <li>Utilice la implementación del reproductor de incrustación en la página para probar la funcionalidad de su reproductor, complemento y CSS (si es necesario CSS)</li>
        <li>Coloque el JavaScript y CSS del plugin en archivos separados para pruebas locales</li>
        <li>Implementa el código del plugin y CSS en tu servidor una vez que hayas resuelto cualquier error.</li>
        <li>Usa Studio para agregar el plugin y CSS a tu reproductor</li>
        <li>Reemplace la implementación del reproductor de incrustación en página si determina que la implementación de iframe se ajusta mejor (se detalla en la siguiente sección)</li>
      </ol>
      <p>Para obtener más información sobre estos pasos, consulte la sección <a href="/coding-topics/step-step-plugin-development.html">Paso a paso: </a> Guía de desarrollo de plugins.</p>
      <h3>iframe o incrustación en página</h3>
      <p>Al desarrollar mejoras para Brightcove Player, deberás decidir si el código se ajusta mejor a la implementación de iframe o incrustación en la página. La recomendación de práctica recomendada es crear un complemento para usarlo con una implementación de iframe. Las ventajas de utilizar el reproductor iframe son:</p>
      <ul>
        <li>Sin colisiones con JavaScript y/o CSS existentes</li>
        <li>Responde automáticamente</li>
        <li>El iframe facilita el uso en aplicaciones de redes sociales (o siempre que el vídeo tenga que «viajar» a otras aplicaciones)</li>
      </ul>
      <p>Aunque la integración del reproductor de incrustación en la página puede ser más compleja, hay ocasiones en que planificará el código en torno a esa implementación. Para generalizar, este enfoque es mejor cuando la página que contiene necesita comunicarse con el reproductor. En concreto, estos son algunos ejemplos:</p>
      <ul>
        <li>El código de la página que contiene necesita escuchar y actuar en función de los eventos de los jugadores</li>
        <li>El reproductor utiliza estilos de la página que lo contiene</li>
        <li>El iframe hará que la lógica de la aplicación falle, como un redireccionamiento desde la página que contiene</li>
      </ul>
      <p>Incluso si tu implementación final no utiliza el código iframe, puedes seguir usando el código de incrustación en la página con un plugin para tu JavaScript y un archivo separado para tu CSS. Esto encapsula tu lógica para que puedas utilizarla fácilmente en varios reproductores.</p>
    </details>
  </section>
  <section class="bcls-section">
    <h2 id="Middleware_functions">Funciones de middleware</h2>
    <p>En este ejemplo se utiliza middleware Video.js para implementar la solución de código. En un nivel muy alto, los casos de uso en los que el middleware es de mayor valor es cuando desea interceptar y alterar los comportamientos principales del reproductor, como establecer la fuente o la hora actual. El middleware Video.js en general no se analiza extensamente en este documento, pero se explica el código real utilizado para la función middleware. Aquí hay documentos de fuentes Video.js que detallan el middleware:</p>
    <ul>
      <li><a href="http://docs.videojs.com/tutorial-middleware.html">Middleware (del conjunto de documentación Video.js)</a></li>
      <li><a href="http://blog.videojs.com/feature-spotlight-middleware/">Característica Spotlight: Middleware (del blog Video.js)</a></li>
      <li><a href="https://github.com/videojs/videojs-playbackrate-adjuster">videojs-playbackrate-adjuster (una aplicación de ejemplo)</a></li>
    </ul>
    <h3>Implementación de funciones de middleware con Brightcove Player</h3>
    <p>La forma más sencilla de utilizar una función middleware es:</p>
    <ol class="bcls-tasklist__restart">
      <li>Escribe la función middleware.</li>
      <li>Coloque la función middleware en la página con el reproductor en una <code translate="No">script</code> etiqueta o incluya la función middleware utilizando el <code translate="No">src</code> atributo con un <code translate="No">script</code> etiqueta. Ambas implementaciones se mostrarán en este documento.</li>
      <li>Registre la función middleware con el reproductor utilizando el <code translate="No">use()</code> método, como se muestra a continuación:
        <pre class="line-numbers">
<code class="language-javascript" translate="No">videojs.use('mimeType', functionName);</code></pre>
        <p>Para el <strong>tipo mime,</strong> puede utilizar un tipo mime de vídeo estándar, como <strong>video/mp4</strong>, o usar un <strong>*</strong> si desea que la función middleware actúe sobre todos mimetipos.</p>
        <aside class="bcls-aside bcls-aside--tip">Se pueden configurar complementos y middleware para que se registren automáticamente cuando se incluyen sus scripts. En este caso, no necesitaría utilizar el <code translate="No">videojs.use()</code> método.</aside>
      </li>
    </ol>
  </section>
  <section class="bcls-section">
    <h2 id="API/Plugin_resources_used">Recursos de API/plugins utilizados</h2>
    <!-- UPDATE table, remove unneeded columns -->
    
    <table class="bcls-table">
      <thead class="bcls-table__head">
        <tr>
          <th>Clases API</th>
          <th>Métodos API</th>
        </tr>
      </thead>
      <tbody class="bcls-table__body">
        <tr>
          <td><a href="https://docs.brightcove.com/brightcove-player/current-release/ControlBar.html">Barra de control</a></td>
          <td><a href="https://docs.brightcove.com/brightcove-player/current-release/ControlBar.html#addChild">Barra de control.addChild ()</a></td>
        </tr>
        <tr>
          <td><a href="https://docs.brightcove.com/brightcove-player/current-release/PlaybackRateMenuButton.html">Botón Menú Velocidad de reproducción</a></td>
          <td>&nbsp;</td>
        </tr>
      </tbody>
    </table>
  </section>
  <!-- UPDATE player and HTML configuration -->
  
  <section class="bcls-section">
    <h2 id="Player/HTML_configuration">Configuración de reproductor/HTML</h2>
    <p>En esta sección se detalla cualquier configuración especial necesaria durante la creación del reproductor. Además, se describen otros elementos HTML que deben agregarse a la página, más allá del código de implementación del reproductor de incrustación de la página.</p>
    <h3>Configuración del reproductor</h3>
    <p>No se requiere ninguna configuración especial para el reproductor de Brightcove que crea para este ejemplo.</p>
    <h3>Otros HTML</h3>
    <p>Recuerda añadir el <code translate="No">id</code> atributo a la <code translate="No">video</code> etiqueta en el código de inserción del reproductor.</p>
    <pre>
<code class="language-html" translate="No">&lt;video-js <span class="bcls-highlight">id="myPlayerID"</span>
...</code></pre>
  </section>
  <!-- UPDATE application flow -->
  
  <section class="bcls-section">
    <h2 id="Application_flow">Flujo de aplicaciones</h2>
    <p>La lógica básica detrás de esta aplicación es:</p>
    <ul>
      <li>Definir las funciones de middleware</li>
      <li>Registra el middleware con el reproductor</li>
      <li>Definir las opciones de velocidad de reproducción</li>
      <li>Inicializar el botón de velocidad de reproducción</li>
    </ul>
    <!-- UPDATE task 1 -->
    
    <h3>Definir las funciones de middleware</h3>
    <p>Busque el código etiquetado:</p>
    <pre>
<code class="language-javascript" translate="No">// +++ Define the middleware functions +++</code></pre>
    <p>Cree las siguientes funciones de middleware:</p>
    <ol class="bcls-tasklist__restart">
      <li>Cree una función de middleware de soporte que vuelva a calcular las horas de inicio y finalización de la reproducción en función de la velocidad de reproducción seleccionada.</li>
      <li>
        <p>Cree una función de middleware que actualizará la hora de inicio, la duración e incluso la hora actual cuando busque.</p>
        <p>La sintaxis básica para crear una función middleware es la siguiente:</p>
        <pre class="line-numbers">
<code class="language-javascript" translate="No">const playbackrateAdjuster = function(player) {
   return {
   ...
 };</code></pre>
        <p>Tenga en cuenta que el <code translate="No">player</code> objeto se pasa a la función.</p>
        <p>Esta función de middleware hace lo siguiente:</p>
        <ol>
          <li><strong>Escuche el evento de cambio de tasa</strong>: Cuando se cambia la velocidad de reproducción, active el <code translate="No">durationchange</code> y <code translate="No">timeupdate</code> eventos.</li>
          <br />
          <li><strong>Implementar el método setSource ()</strong>: Este es un método obligatorio para cada función de middleware. Utilizando la sintaxis mostrada significa que el middleware siempre estará seleccionado, independientemente del tipo de vídeo:
            <pre>
<code class="language-javascript" translate="No">setSource(srcObj, next) {
  next(null, srcObj);
},</code></pre>
          </li>
          <br />
          <li><strong>Anular métodos usando la tasa de reproducción actual</strong>: Anular los métodos para <code translate="No">duration</code> , <code translate="No">currentTime</code> , <code translate="No">buffered</code> , <code translate="No">seekable</code> y <code translate="No">played</code> con valores calculados utilizando la tasa de reproducción actual.</li>
        </ol>
      </li>
    </ol>
    <!-- UPDATE task 5 -->
    
    <h3>Registra el middleware con el reproductor</h3>
    <p>Busque el código etiquetado:</p>
    <pre>
<code class="language-javascript" translate="No">// +++ Register the middleware with the player +++</code></pre>
    <p>Registre la función de middleware con el reproductor utilizando el <code translate="No">use()</code> método.</p>
    <!-- UPDATE task 6 -->
    
    <h3>Definir las opciones de velocidad de reproducción</h3>
    <p>Busque el código etiquetado:</p>
    <pre>
<code class="language-javascript" translate="No">// +++ Define the playback rate options +++</code></pre>
    <p>Defina las velocidades de reproducción que desea que se muestren en el botón del menú de velocidad de reproducción.</p>
    <!-- UPDATE task 7 -->
    
    <h3>Inicializar el botón de velocidad de reproducción</h3>
    <p>Busque el código etiquetado:</p>
    <pre>
<code class="language-javascript" translate="No">// +++ Initialize the playback rate button +++</code></pre>
    <p>Agregue el botón del menú de velocidad de reproducción a la barra de control del reproductor e inicialícelo con los valores especificados en el objeto de opciones.</p>
  </section>
  <!-- UPDATE CSS description -->
  
  <section class="bcls-section">
    <h2 id="Application_styling">Estilismo de aplicaciones</h2>
    <p>No hay estilos adicionales para este ejemplo.</p>
  </section>
  <section class="bcls-section">
    <h2 id="Using_the_middleware_function">Uso de la función middleware</h2>
    <p>Una vez que se haya escrito la función middleware, desea usarla. Antes se mencionaron dos formas y se detallarán ahora.</p>
    <h3>Código en la misma página que el reproductor</h3>
    <p>Aquí es donde define la función de middleware en la misma página que el reproductor y luego la registra. La <a href="#Player_example">ejemplo de jugador</a> en el Codepen anterior utiliza este método.</p>
    <h3 id="Code_in_a_separate_JavaScript_file">Código en un archivo JavaScript separado</h3>
    <p>En el siguiente código, JavaScript para las funciones de middleware y <code translate="No">use()</code> El método para registrarlo simplemente se incluye en la página.</p>
    <pre class="line-numbers">
<code class="language-html" translate="No">&lt;video-js id="myPlayerID"
	  data-video-id="5604123528001"
	  data-account="1752604059001"
	  data-player="default"
	  data-embed="default"
	  data-application-id
	  class="video-js"
	  width="640" height="360"
	  controls muted&gt;&lt;/video&gt;
	&lt;script src="https://players.brightcove.net/1752604059001/default_default/index.min.js"&gt;&lt;/script&gt;

  &lt;!-- Include the rate adjuster middleware functions --&gt;
  &lt;script src="rate-adjuster.js"&gt;&lt;/script&gt;

  &lt;script type="text/javascript"&gt;
  	videojs.getPlayer("myPlayerID").ready(function(){
  		// When the player is ready, get a reference to it
  		var myPlayer = this;
  		console.log("myPlayer",myPlayer)
  		// Define the playback rate options
  		options = {"playbackRates":[0.5, 1, 1.5, 2, 4]};
  		// Initialize the playback rate button
  		myPlayer.controlBar.playbackRateMenuButton = myPlayer.controlBar.addChild('PlaybackRateMenuButton', {
      	playbackRates: options.playbackRates
  	  });
    });
  &lt;/script&gt;</code></pre>
    <p>Este ejemplo asume que alojará el archivo JavaScript en su propio servidor. Para obtener el código completo, consulte el <a href="https://github.com/BrightcoveLearning/18597-playback-rate-adjuster/tree/master/plugin">sección de complementos</a> en el repositorio de GitHub.</p>
    <aside class="bcls-aside bcls-aside--tip">
      <p>La <strong>ajustador de velocidad de reproducción de videojs</strong> el middleware se publica en <strong>npm</strong> y disponible para incluir en su proyecto: <a href="//unpkg.com/videojs-playbackrate-adjuster@1.0.0/dist/browser/videojs-playbackrate-adjuster.min.js">//unpkg.com/videojs-playbackrate-adjuster@1.0.0/dist/browser/videojs-playbackrate-adjuster.min.js</a></p>
      <p>Tenga en cuenta que el <strong>unpkg.com</strong> El sitio es gratuito y de código abierto. No garantiza el tiempo de actividad ni el soporte de la infraestructura.</p>
    </aside>
  </section>
</article>